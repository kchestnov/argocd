{{- range .Values.dashboards }}
{{- $folderTitle := .folderTitle }}
{{- $folderUid := .folderUid }}
{{- range .dashboards }}
{{- $jsonContent := .json | fromJson }}
{{- $title := $jsonContent.title | lower | replace " " "-" }}
---
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDashboard
metadata:
  name: {{ printf "%s-%s" $folderTitle $title }}
spec:
  resyncPeriod: 30s
  instanceSelector:
    matchLabels:
      dashboards: grafana-prod
  folder: {{ $folderTitle }}
  json: >
{{- .json | nindent 4 }}
{{- end }}
{{- end }}