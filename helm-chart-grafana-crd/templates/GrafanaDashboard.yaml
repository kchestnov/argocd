{{- $dashboards := .Values.dashboards -}}
{{- range $folderName, $folderData := $dashboards -}}
{{- $folderUid := $folderData.folderUid -}}
{{- range $dashboardName, $dashboardData := $folderData.dashboards -}}
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDashboard
metadata:
  name: {{ $dashboardName | quote }}
spec:
  resyncPeriod: 30s
  instanceSelector:
    matchLabels:
      dashboards: "grafana-prod"
  folder: {{ $folderName | quote }}
  json: {{ $dashboardData.json | quote }}
{{- end -}}
{{- end -}}